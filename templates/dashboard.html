<!DOCTYPE html>
<html>
<head>
    <title>Smart Crop IoT Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial; text-align: center; background: #f4f4f4; }
        h1 { color: green; }
        canvas { background: white; padding: 20px; border-radius: 10px; }
    </style>
</head>
<body>

<h1>ðŸŒ± Smart Crop IoT Dashboard</h1>

<canvas id="sensorChart" width="800" height="400"></canvas>

<script>
const ctx = document.getElementById('sensorChart').getContext('2d');

let chart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [],
        datasets: [
            {
                label: 'Moisture',
                borderColor: 'blue',
                data: [],
                fill: false
            },
            {
                label: 'Temperature',
                borderColor: 'red',
                data: [],
                fill: false
            },
            {
                label: 'Humidity',
                borderColor: 'green',
                data: [],
                fill: false
            }
        ]
    }
});

async function fetchData() {
    const response = await fetch('/history');
    const data = await response.json();

    chart.data.labels = data.map(d => d.timestamp);
    chart.data.datasets[0].data = data.map(d => d.moisture);
    chart.data.datasets[1].data = data.map(d => d.temperature);
    chart.data.datasets[2].data = data.map(d => d.humidity);

    chart.update();
}

setInterval(fetchData, 5000);
fetchData();
</script>

</body>
</html>